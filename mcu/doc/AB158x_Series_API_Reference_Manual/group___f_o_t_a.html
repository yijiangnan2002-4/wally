<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>AB158x Series MCU API Reference: FOTA</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="airoha.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AB158x Series MCU API Reference
   &#160;<span id="projectnumber">Airoha IoT SDK for BT Audio</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___f_o_t_a.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">FOTA</div>  </div>
</div><!--header-->
<div class="contents">

<p>File: <a class="el" href="fota_8h_source.html">fota.h</a>.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Overview</h2>
<p>File: <a class="el" href="fota_8h_source.html">fota.h</a>. </p>
<p>Description: This file declares some FOTA SDK APIs.</p>
<p>Note: See doc/Airoha_IoT_SDK_Firmware_Update_Developers_Guide.pdf for more detail.</p>
<p>This section introduces the FOTA interface APIs including terms and acronyms, supported features, details on how to use this interface, FOTA function groups, enums, structures and functions. This interface writes into a pre-defined register flag. The bootloader enters the update process based on the value written in the flag. The return error code indicates if the flag is written successfully or not. After the update is complete, the UA automatically resets the register flag. Note, it is recommended to call the reboot API after calling the FOTA interface, because <a class="el" href="group___f_o_t_a.html#gace5231a7d42d82c897718227a6f389b3" title="Provide the register flag for the bootloader to check whether to enter FOTA update process or not...">fota_trigger_update()</a> does not contain reboot functionality. There is no dedicated FOTA read or write SDK API, it is suggested to use HAL flash SDK API to write data to specified address of flash. Regarding to the FOTA update flow &amp; usage, please refer to the Firmware Update Developers Guide located under [sdk_root]/doc folder.</p>
<h1><a class="anchor" id="fota_terms"></a>
Terms and acronyms</h1>
<table class="doxtable">
<tr>
<th>Terms </th><th>Details  </th></tr>
<tr>
<td><b>FOTA</b> </td><td>Firmware Over-The-Air (FOTA) is a Mobile Software Management technology in which the operating firmware of a mobile device is wirelessly upgraded and updated by its manufacturer. Please refer to <a href="https://www.techopedia.com/definition/24236/firmware-over-the-air-fota">FOTA in Techopedia.</a> </td></tr>
<tr>
<td><b>UA</b> </td><td>Update Agent performs the actual FOTA update on devices. It operates as stand-alone application in bootloader and replaces the old firmware with the new one. </td></tr>
</table>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gace5231a7d42d82c897718227a6f389b3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__fota__enum.html#gacdd1cc6b35e581701d5d66e24bddd7b5">fota_ret_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_o_t_a.html#gace5231a7d42d82c897718227a6f389b3">fota_trigger_update</a> (void)</td></tr>
<tr class="memdesc:gace5231a7d42d82c897718227a6f389b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide the register flag for the bootloader to check whether to enter FOTA update process or not.  <a href="#gace5231a7d42d82c897718227a6f389b3">More...</a><br /></td></tr>
<tr class="separator:gace5231a7d42d82c897718227a6f389b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3d3cf1d0b8b139b64809b093bcdd68b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_o_t_a.html#ga3d3cf1d0b8b139b64809b093bcdd68b1">fota_get_upgrade_result</a> (bool *result)</td></tr>
<tr class="memdesc:ga3d3cf1d0b8b139b64809b093bcdd68b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the upgrade result for the last FOTA.  <a href="#ga3d3cf1d0b8b139b64809b093bcdd68b1">More...</a><br /></td></tr>
<tr class="separator:ga3d3cf1d0b8b139b64809b093bcdd68b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadacc8ae4d114de2c2329e7c89a151fe8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_o_t_a.html#gadacc8ae4d114de2c2329e7c89a151fe8">fota_check_upgrade_flag</a> (bool *upgrade_flag_set)</td></tr>
<tr class="memdesc:gadacc8ae4d114de2c2329e7c89a151fe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the upgrade flag is set or not.  <a href="#gadacc8ae4d114de2c2329e7c89a151fe8">More...</a><br /></td></tr>
<tr class="separator:gadacc8ae4d114de2c2329e7c89a151fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga850d4c96ace7107caad48468d7afdebf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_o_t_a.html#ga850d4c96ace7107caad48468d7afdebf">fota_init_flash</a> (void)</td></tr>
<tr class="memdesc:ga850d4c96ace7107caad48468d7afdebf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the flash driver and configurate the flash for FOTA.  <a href="#ga850d4c96ace7107caad48468d7afdebf">More...</a><br /></td></tr>
<tr class="separator:ga850d4c96ace7107caad48468d7afdebf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga66bde7105017243ee5d1d284c3c187b9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_o_t_a.html#ga66bde7105017243ee5d1d284c3c187b9">fota_nvdm_is_incompatible_flag_set</a> (void)</td></tr>
<tr class="memdesc:ga66bde7105017243ee5d1d284c3c187b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether the NVDM incompatible flag is set.  <a href="#ga66bde7105017243ee5d1d284c3c187b9">More...</a><br /></td></tr>
<tr class="separator:ga66bde7105017243ee5d1d284c3c187b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadcbe4c6b8c5730b2529b77033165bc3b"><td class="memItemLeft" align="right" valign="top">FOTA_ERRCODE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_o_t_a.html#gadcbe4c6b8c5730b2529b77033165bc3b">fota_nvdm_clear_incompatible_flag</a> (void)</td></tr>
<tr class="memdesc:gadcbe4c6b8c5730b2529b77033165bc3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear the NVDM incompatible flag.  <a href="#gadcbe4c6b8c5730b2529b77033165bc3b">More...</a><br /></td></tr>
<tr class="separator:gadcbe4c6b8c5730b2529b77033165bc3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__fota__enum"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fota__enum.html">Enums</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gadacc8ae4d114de2c2329e7c89a151fe8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fota_check_upgrade_flag </td>
          <td>(</td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>upgrade_flag_set</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the upgrade flag is set or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">upgrade_flag_set</td><td>TRUE: set, FALSE: not set. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga3d3cf1d0b8b139b64809b093bcdd68b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fota_get_upgrade_result </td>
          <td>(</td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>result</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the upgrade result for the last FOTA. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">result</td><td>The upgrade result, TRUE: succeed, FALSE: fail. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga850d4c96ace7107caad48468d7afdebf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fota_init_flash </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the flash driver and configurate the flash for FOTA. </p>
<p>It should be called before any other FOTA API is called. </p>

</div>
</div>
<a class="anchor" id="gadcbe4c6b8c5730b2529b77033165bc3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FOTA_ERRCODE fota_nvdm_clear_incompatible_flag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear the NVDM incompatible flag. </p>
<dl class="section return"><dt>Returns</dt><dd>FOTA_ERRCODE_SUCCESS, Success; Otherwise, Fail. </dd></dl>

</div>
</div>
<a class="anchor" id="ga66bde7105017243ee5d1d284c3c187b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fota_nvdm_is_incompatible_flag_set </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check whether the NVDM incompatible flag is set. </p>
<dl class="section return"><dt>Returns</dt><dd>TRUE, it is set; FALSE, it is not set. </dd></dl>

</div>
</div>
<a class="anchor" id="gace5231a7d42d82c897718227a6f389b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__fota__enum.html#gacdd1cc6b35e581701d5d66e24bddd7b5">fota_ret_t</a> fota_trigger_update </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provide the register flag for the bootloader to check whether to enter FOTA update process or not. </p>
<dl class="section return"><dt>Returns</dt><dd>FOTA_TRIGGER_SUCCESS/FOTA_TRIGGER_FAIL. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Call the reboot API after using this function. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;//Trigger a FOTA update.</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;fota_ret_t ret;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;ret = fota_trigger_update();</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;if (ret != FOTA_TRIGGER_SUCCESS)</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;{</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    // Failed to write the register flag, error handling.</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;}</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;// Call the reboot API, hal_wdt_software_reset().</div></div><!-- fragment --> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Dec 29 2023 02:13:05 for AB158x Series MCU API Reference by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
