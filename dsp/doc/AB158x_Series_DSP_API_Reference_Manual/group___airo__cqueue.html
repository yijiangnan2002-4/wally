<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>AB158x Series DSP API Reference: Airo_cqueue</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="airoha.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AB158x Series DSP API Reference
   &#160;<span id="projectnumber">Airoha IoT SDK for BT Audio</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___airo__cqueue.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">Airo_cqueue<div class="ingroups"><a class="el" href="group__kernel__service.html">Kernel_service</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This section introduces the airo_cqueue APIs including supported features, software architecture, and details on how to use airo_cqueue structures and functions.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Overview</h2>
<p>This section introduces the airo_cqueue APIs including supported features, software architecture, and details on how to use airo_cqueue structures and functions. </p>
<p>Airo_cqueue is a lightweight fixed size queue service. It can be used to send messages between tasks, and between interrupts and tasks. It is used as a thread-safe First In First Out (FIFO) buffer with new data being sent to the back of the queue. Suggest Airo_cqueue is used only when the system doesn't have operation system, such as FreeRTOS, because of the limited function.</p>
<h1><a class="anchor" id="Airo_cqueue_Usage_Chapter"></a>
How to use airo_cqueue</h1>
<p>Use airo_cqueue to create a queue. Then, send to and receive from the queue. For example:</p><ul>
<li><b>Step</b> 1. Include airo_cqueue module.mk in your project makefile. <div class="fragment"><div class="line"><span class="comment">//file:dsp\project\ab1558_evk\templates\dsp1_create_message_queue\XT-XCC\Makefile</span></div><div class="line"><span class="preprocessor"> ################################################################################</span></div><div class="line"><span class="preprocessor"> # Include Module Configuration</span></div><div class="line"><span class="preprocessor"> ################################################################################</span></div><div class="line"><span class="preprocessor"> include $(ROOTDIR)/kernel/service/airo_cqueue/module.mk</span></div></div><!-- fragment --></li>
<li><b>Step</b> 2. Define the queue message structure. Queue item counts as your request, and statically allocates memory for the queue. Note: The buffer must be allocated at the word aligned address, and must also include the queue ctrl block size size(airo_cqueue_t). <div class="fragment"><div class="line"><span class="comment">//file:dsp\project\ab1558_evk\templates\dsp1_create_message_queue\inc\message_queue_configure.h</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line">    message_event_id_t event_id;</div><div class="line">} message_queue_t;</div><div class="line"><span class="comment">//file:dsp\project\ab1558_evk\templates\dsp1_create_message_queue\src\main.c</span></div><div class="line"><span class="preprocessor">#define MESSAGE_QUEUE_ITEMS 16</span></div><div class="line"><span class="keywordtype">void</span> *p_message_queue = NULL;</div><div class="line">__attribute__((__aligned__(4))) char queue_buffer[sizeof(<a class="code" href="structairo__cqueue__t.html">airo_cqueue_t</a>) + MESSAGE_QUEUE_ITEMS * sizeof(message_queue_t)];</div></div><!-- fragment --></li>
<li><b>Step</b> 3. Call <a class="el" href="group___airo__cqueue.html#ga44856abb6a6ec71402e24b21e01badfc" title="This function creates a queue. ">airo_cqueue_create()</a> to create a queue. <div class="fragment"><div class="line"><span class="comment">//file:dsp\project\ab1558_evk\templates\dsp1_create_message_queue\src\main.c</span></div><div class="line">p_message_queue = <a class="code" href="group___airo__cqueue.html#ga44856abb6a6ec71402e24b21e01badfc">airo_cqueue_create</a>(MESSAGE_QUEUE_ITEMS, <span class="keyword">sizeof</span>(message_queue_t), (<span class="keywordtype">void</span> *)queue_buffer);</div><div class="line">assert(p_message_queue);</div></div><!-- fragment --></li>
<li><b>Step</b> 4. Package a message and call <a class="el" href="group___airo__cqueue.html#gae23d9e19d7058ee7f1d8777fb47e7a2e" title="This function sends a message to the queue. ">airo_cqueue_send()</a> to send the messgae to the queue. <div class="fragment"><div class="line"><span class="comment">//file:dsp\kernel\service\pre_libloader\dsp1\dsp1_pic_demo_portable\dsp1_pisplit_demo_library_portable.c</span></div><div class="line"><span class="keywordtype">bool</span> ret = <span class="keyword">false</span>;</div><div class="line">message_queue_t dsp1_lib_demo_message;</div><div class="line">dsp1_lib_demo_message.event_id = MESSAGE_DSP1_PISPLIT_LIBRARY_DEMO_LOADING_DONE;</div><div class="line">ret = <a class="code" href="group___airo__cqueue.html#gae23d9e19d7058ee7f1d8777fb47e7a2e">airo_cqueue_send</a>(p_message_queue, (<span class="keywordtype">void</span> *)&amp;dsp1_lib_demo_message);</div><div class="line">assert(ret);</div></div><!-- fragment --></li>
<li><b>Step</b> 5. Call <a class="el" href="group___airo__cqueue.html#gaca7bdc779a2f6f46f7bb6323a2797a2a" title="This function receives a message from the queue. ">airo_cqueue_receive()</a> to receive a message from the queue. <div class="fragment"><div class="line"><span class="comment">//file:dsp\project\ab1558_evk\templates\dsp1_create_message_queue\src\main.c</span></div><div class="line"><span class="comment">//Main loop to handle message</span></div><div class="line"><span class="keywordflow">while</span> (<a class="code" href="group___airo__cqueue.html#gaa79f2be1d6da7a7d79f1b5cd3dccd002">airo_cqueue_message_waiting</a>(p_message_queue)) {</div><div class="line">    <span class="comment">//Receive a message from preloader queue</span></div><div class="line">    ret = <a class="code" href="group___airo__cqueue.html#gaca7bdc779a2f6f46f7bb6323a2797a2a">airo_cqueue_receive</a>(p_message_queue, (<span class="keywordtype">void</span> *)&amp;message);</div><div class="line">    <span class="keywordflow">if</span> (ret) {</div><div class="line">        <span class="comment">//......</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> </li>
</ul>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga44856abb6a6ec71402e24b21e01badfc"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___airo__cqueue.html#ga44856abb6a6ec71402e24b21e01badfc">airo_cqueue_create</a> (uint32_t queue_len, uint32_t item_size, void *buffer)</td></tr>
<tr class="memdesc:ga44856abb6a6ec71402e24b21e01badfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function creates a queue.  <a href="#ga44856abb6a6ec71402e24b21e01badfc">More...</a><br /></td></tr>
<tr class="separator:ga44856abb6a6ec71402e24b21e01badfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae23d9e19d7058ee7f1d8777fb47e7a2e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___airo__cqueue.html#gae23d9e19d7058ee7f1d8777fb47e7a2e">airo_cqueue_send</a> (void *qHandle, const void *const pItem)</td></tr>
<tr class="memdesc:gae23d9e19d7058ee7f1d8777fb47e7a2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sends a message to the queue.  <a href="#gae23d9e19d7058ee7f1d8777fb47e7a2e">More...</a><br /></td></tr>
<tr class="separator:gae23d9e19d7058ee7f1d8777fb47e7a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaca7bdc779a2f6f46f7bb6323a2797a2a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___airo__cqueue.html#gaca7bdc779a2f6f46f7bb6323a2797a2a">airo_cqueue_receive</a> (void *qHandle, void *const pUser_buffer)</td></tr>
<tr class="memdesc:gaca7bdc779a2f6f46f7bb6323a2797a2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function receives a message from the queue.  <a href="#gaca7bdc779a2f6f46f7bb6323a2797a2a">More...</a><br /></td></tr>
<tr class="separator:gaca7bdc779a2f6f46f7bb6323a2797a2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga363627e1f9e5515d8b1e8e07665e7bc2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___airo__cqueue.html#ga363627e1f9e5515d8b1e8e07665e7bc2">airo_cqueue_is_full</a> (void *qHandle)</td></tr>
<tr class="memdesc:ga363627e1f9e5515d8b1e8e07665e7bc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks whether the queue is full.  <a href="#ga363627e1f9e5515d8b1e8e07665e7bc2">More...</a><br /></td></tr>
<tr class="separator:ga363627e1f9e5515d8b1e8e07665e7bc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c62c366500d988c1f35e66ff23f42b5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___airo__cqueue.html#ga8c62c366500d988c1f35e66ff23f42b5">airo_cqueue_is_empty</a> (void *qHandle)</td></tr>
<tr class="memdesc:ga8c62c366500d988c1f35e66ff23f42b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks whether the queue is empty.  <a href="#ga8c62c366500d988c1f35e66ff23f42b5">More...</a><br /></td></tr>
<tr class="separator:ga8c62c366500d988c1f35e66ff23f42b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa79f2be1d6da7a7d79f1b5cd3dccd002"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___airo__cqueue.html#gaa79f2be1d6da7a7d79f1b5cd3dccd002">airo_cqueue_message_waiting</a> (void *qHandle)</td></tr>
<tr class="memdesc:gaa79f2be1d6da7a7d79f1b5cd3dccd002"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function queries the message count in the queue.  <a href="#gaa79f2be1d6da7a7d79f1b5cd3dccd002">More...</a><br /></td></tr>
<tr class="separator:gaa79f2be1d6da7a7d79f1b5cd3dccd002"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__airo__cqueue"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__airo__cqueue.html">Struct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga44856abb6a6ec71402e24b21e01badfc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* airo_cqueue_create </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>queue_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>item_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function creates a queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">queue_len</td><td>is the maximum number of items that the queue can contain. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">item_size</td><td>is the number of bytes each item in the queue will require. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buffer</td><td>is the queue space. It must be allocated at the word aligned address, and must also include the queue ctrl block size, which is sizeof(airo_cqueue_t). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the queue handle if the queue is successfully created.<br />
NULL if the queue creation fails. </dd></dl>

</div>
</div>
<a class="anchor" id="ga8c62c366500d988c1f35e66ff23f42b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool airo_cqueue_is_empty </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>qHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks whether the queue is empty. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qHandle</td><td>is the handle to the queue on which the item is to be posted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return true, the queue is empty. <br />
return false, the queue is not empty. </dd></dl>

</div>
</div>
<a class="anchor" id="ga363627e1f9e5515d8b1e8e07665e7bc2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool airo_cqueue_is_full </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>qHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks whether the queue is full. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qHandle</td><td>is the handle to the queue on which the item is to be posted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return true, the queue is full. <br />
return false, the queue is not full. </dd></dl>

</div>
</div>
<a class="anchor" id="gaa79f2be1d6da7a7d79f1b5cd3dccd002"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t airo_cqueue_message_waiting </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>qHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function queries the message count in the queue. </p>
<p>It is equal to the number of the messages waiting to be received in the queue. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qHandle</td><td>is the handle to the queue on which the item is to be posted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return the number of messages in the queue <br />
</dd></dl>

</div>
</div>
<a class="anchor" id="gaca7bdc779a2f6f46f7bb6323a2797a2a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool airo_cqueue_receive </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>qHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>pUser_buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function receives a message from the queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qHandle</td><td>is the handle to the queue on which the item is to be posted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pUser_buffer</td><td>is the buffer into which the received item will be copied. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return true, a message is successfully received from the queue. <br />
return false, a message failed to be received from the queue. </dd></dl>

</div>
</div>
<a class="anchor" id="gae23d9e19d7058ee7f1d8777fb47e7a2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool airo_cqueue_send </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>qHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *const&#160;</td>
          <td class="paramname"><em>pItem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sends a message to the queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qHandle</td><td>is the handle to the queue on which the item is to be posted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pItem</td><td>is a pointer to the item that is to be put on the queue. The size of the items the queue will hold was defined when the queue was created, so this number of bytes is copied from pItem into the queue storage area. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return true, the message is successfully sent to the queue.<br />
return false, the message failed to be sent to the queue. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Dec 29 2023 02:13:18 for AB158x Series DSP API Reference by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
